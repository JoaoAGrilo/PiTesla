name: ðŸš€ Deploy APK

on: 
    push: 
      branches: [ 'main' ]

jobs:
    deploy:
        name: ðŸŽ‰ Deploy
        runs-on: ubuntu-latest

        steps:
            - name: 'â˜• Install Java 17'
              uses: actions/setup-java@v4
              with:
                distribution: 'temurin'
                java-version: '17'

            - name: ðŸšš Get latest code
              uses: actions/checkout@v4
              with:
                fetch-depth: 2

            - name: ðŸ›  Install Dependencies
              run: |
                npm install

            - name: ðŸ’» Build Android
              run: |
                cd android
                ./gradlew assembleRelease
      
            - name: ðŸ“‚ Send APK to Cpanel
              uses: SamKirkland/FTP-Deploy-Action@v4.3.5
              with:
                server: ${{ secrets.FTP_SERVER }}
                username: ${{ secrets.FTP_USERNAME }}
                password: ${{ secrets.FTP_PASSWORD }}
                port: ${{ secrets.FTP_PORT }}
                local-dir: './android/app/build/outputs/apk/release/'
                server-dir: './public/apk/'